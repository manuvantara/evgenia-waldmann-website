---
import { Image } from "astro:assets";
import MobileMenu from "./MobileMenu.astro";
import logo from "../assets/logo.png";

const items = [
  {
    name: "Программа",
    href: "#program",
  },
  {
    name: "Обо мне",
    href: "#about-me",
  },
  {
    name: "Отзывы",
    href: "#reviews",
  },
  {
    name: "Ответы на вопросы",
    href: "#faq",
  },
];
---

<header
  data-header
  data-scrolled="false"
  class="sticky top-0 z-50 mx-auto max-w-[1440px] bg-stromboli-700 px-4 pb-8 pt-6 lg:data-[scrolled=true]:rounded-b-[128px]"
>
  <div class="container flex items-center justify-between">
    <Image src={logo} alt="Logo" width={100} height={48} loading="eager" />
    <nav class="hidden rounded-3xl bg-stromboli-600 px-8 py-4 lg:block">
      <ul class="flex gap-[42px] text-sm font-semibold text-stromboli-200">
        {
          items.map((item) => (
            <li>
              <a href={item.href}>{item.name}</a>
            </li>
          ))
        }
      </ul>
    </nav>

    <a
      href="#contact"
      class="hidden rounded-3xl border border-reef-200 px-6 py-3 font-semibold text-reef-200 lg:block"
    >
      Оставить заявку
    </a>

    <button
      data-menu-button
      class="block size-8 fill-stromboli-50 lg:hidden"
      aria-label="Menu"
    >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
        <path
          d="M160-240q-17 0-28.5-11.5T120-280q0-17 11.5-28.5T160-320h640q17 0 28.5 11.5T840-280q0 17-11.5 28.5T800-240H160Zm0-200q-17 0-28.5-11.5T120-480q0-17 11.5-28.5T160-520h640q17 0 28.5 11.5T840-480q0 17-11.5 28.5T800-440H160Zm0-200q-17 0-28.5-11.5T120-680q0-17 11.5-28.5T160-720h640q17 0 28.5 11.5T840-680q0 17-11.5 28.5T800-640H160Z"
        ></path>
      </svg>
    </button>

    <MobileMenu data-menu data-state="closed" items={items} />
  </div>
</header>

<script>
  const header = document.querySelector("[data-header]");
  const menuButton = document.querySelector("[data-menu-button]");
  const menu = document.querySelector("[data-menu]");

  if (!header || !menuButton || !menu) {
    throw new Error("Header, menu button or menu not found");
  }

  const { height } = header?.getBoundingClientRect();

  window.addEventListener("scroll", () => {
    if (window.scrollY > height) {
      header?.setAttribute("data-scrolled", "true");
    } else {
      header?.setAttribute("data-scrolled", "false");
    }
  });

  menuButton?.addEventListener("click", () => {
    menu?.setAttribute("data-state", "open");
  });
</script>
